<div class="container mt-5">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h4 class="mb-0">Meine Mengenmeldungen</h4>
    <button class="btn btn-primary btn-lg" routerLink="/mengenmeldungen/new">
      Neue Mengenmeldung
    </button>
  </div>

  <div class="mb-3 row align-items-center">
    <label for="table-complete-search" class="col-sm-auto col-form-label"> Suche: </label>

    <div class="col-sm-4">
      <input
        id="table-complete-search"
        type="text"
        class="form-control"
        placeholder="Zeitraum, Einheit, Status..."
        (input)="searchTerm.set($any($event.target).value)"
      />
    </div>
  </div>

  <div class="table-responsive rounded-2">
    <table class="table table-hover align-middle mb-0">
      <thead class="table-primary">
        <tr>
          <th role="button">
            Zeitraum
            <span class="ms-1 text-muted">⇅</span>
          </th>

          <th role="button">
            Menge
            <span class="ms-1 text-muted">⇅</span>
          </th>

          <th role="button">
            Einheit
            <span class="ms-1 text-muted">⇅</span>
          </th>

          <th role="button">
            Geräteart
            <span class="ms-1 text-muted">⇅</span>
          </th>

          <th role="button">
            Registrierungsnr.
            <span class="ms-1 text-muted">⇅</span>
          </th>

          <th role="button">
            Status
            <span class="ms-1 text-muted">⇅</span>
          </th>
        </tr>
      </thead>

      <tbody>
        @for (m of mengenmeldungen(); track m.id) {
          <tr>
            <td>{{ m.zeitraum }}</td>
            <td>{{ m.menge }}</td>
            <td>{{ m.einheit }}</td>
            <td>{{ m.geraeteartnummer }}</td>
            <td>{{ m.registrierungsnummer }}</td>
            <td>
              <button
                type="button"
                class="btn btn-sm"
                [ngClass]="statusClass(m.status)"
                [ngbPopover]="m.errorMessage"
                popoverTitle="Fehlermeldung"
                triggers="mouseenter:mouseleave"
                placement="left"
                [disabled]="!m.errorMessage"
              >
                {{ m.status }}
                @if (m.errorMessage) {
                  <i class="bi bi-info-circle"></i>
                }
              </button>
            </td>
          </tr>
        } @empty {
          <tr>
            <td colspan="6" class="text-center text-muted py-4">Keine Mengenmeldungen gefunden</td>
          </tr>
        }
      </tbody>
    </table>
  </div>

  <div class="d-flex justify-content-end align-items-center mt-3">
    <ngb-pagination
      [collectionSize]="totalElements()"
      [pageSize]="pageSize"
      [boundaryLinks]="true"
      [maxSize]="5"
      [(page)]="page"
      (pageChange)="onPageChange($event)"
    >
    </ngb-pagination>
  </div>
</div>
